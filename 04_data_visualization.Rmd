---
title: "04 Data Visualization"
date: "2021-05"
output:
  html_document:
    toc: true
    toc_float: true
    df_print: paged
    collapsed: false
    number_sections: true
    toc_depth: 3
    code_folding: hide
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(message=FALSE,warning=FALSE, cache=TRUE)
```


```{r}
library(ggplot2)
library(tidyverse)
library(lubridate)
library(dplyr)
library(magrittr)
library(ggplot2)

covid_data_tbl <- read_csv("https://covid.ourworldindata.org/data/owid-covid-data.csv")

# 2. Data manipluation

covid_cases_tbl <- covid_data_tbl %>%
  filter(location %in% c("Germany",
                         "United Kingdom",
                         "France",
                         "Spain",
                         "Algeria",
                         "United States"))
covid_cases_tbl
covid_cases_tbl %>%
  ggplot(aes(x=date, y=total_cases,
             group=location,
             colour=location))+
  geom_line()+
  scale_linetype_discrete(name="location") +
  xlab("Date") + 
  ylab("Total Cases") +
  scale_x_date(date_breaks = "1 month", date_labels =  "%b %Y") +
  scale_y_continuous(breaks=100000)+
  scale_y_continuous(labels = scales::number)+
  theme(axis.text.x=element_text(angle=45, hjust=1))+
  labs(
    title = "Corona virus total cases by country",
    fill = "location"
  )
```

```{r}
library(ggmap)
library(maps)
library(ggplot2)
library(tidyverse)
library(lubridate)
library(dplyr)
library(magrittr)
library(ggplot2)

covid_data_tbl <- read_csv("https://covid.ourworldindata.org/data/owid-covid-data.csv")

world_map <- map_data("world") %>%
  select(region, long, lat, group) %>%
  rename(location = region)

covid_world_tbl <- covid_data_tbl %>%
  #mutate(mortalityrate=total_deaths_per_million/1000000) %>%
  select(date, location, total_deaths_per_million) %>%
  rename(region=location)%>%
  right_join(world_map)
  #%>%
  #group_by(region)

 covid_world_tbl%>% ggplot() +
  geom_map(aes(map_id = region, x=long, y=lat, fill = mortalityrate,color= "red"  ), map = world,colour= "white",size = 0.10)+
   scale_fill_continuous(low = "red",
                        high = "black",
                        na.value = "grey50",
                        guide="colorbar") +
  labs(title = "Confirmed COVID 19 deaths realtive to size of population",
      subtitle = "around 3million confirmed COVID 19 deaths worldwide",fill = "Mortality rate", x="", y="")
```